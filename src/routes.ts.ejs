/* tslint:disable:no-namespace max-line-length quotemark */
import { typeCheck } from './utils';
import { StaticRoute, DynamicRoute, unwrapModule } from './support/routing';
<% keys.forEach(function(page) { %>
import Component<%- routeKeys[page] %>, {
<% if (!routes.find(function(route) { return route.key === routeKeys[page] }).static) {-%>
    Args as Args<%- routeKeys[page] %>,
<% } -%>
    Data as Data<%- routeKeys[page] %>,
    fetchData as fetchData<%- routeKeys[page] %>,
} from <%- "'" + page + "'" %>;
<% }); %><% keys.forEach(function(page) { %>
declare function require(path: <%- "'" + page + "'" %>): {
    default: typeof Component<%- routeKeys[page] %>,
    fetchData: typeof fetchData<%- routeKeys[page] %>,
};
<% }); %>
declare namespace require {
  function ensure(deps: string[], callback: () => void): void;
}

const routes: Array<StaticRoute<{}> | DynamicRoute<{}, {}>> = [];
export default routes;
<% routes.forEach(function(route, idx) { %>
<% if (!route.static) { -%>
typeCheck<Args<%- route.key %>>({} as <%- route.args %>);
<% } -%>
routes.push(new <%- route.type %>(<%- route.path %>, <%- "'" + route.key + "'" %>, (resolve: (mod: <%- route.modType %>) => void) => {
  require.ensure([<%- route.page %>], () => {
    const mod = unwrapModule(require(<%- route.page %>));
    if (process.env.NODE_ENV === 'production') {
      resolve(mod);
    } else {
      setTimeout(() => {
        resolve(mod);
      }, 500);
    }
  });
}));
<% }); -%>
